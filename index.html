<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Umfrage:Schulumgebung</title>
  <style>
      body{
          font-family: sans-serif;
          max-width: 600px;
          margin: auto;
          padding: 2rem;
      }
      .highlighted{
          background-color: #ccffcc;
          border: 2px solid #00aa00;
      }
      .faded{
          color: #888;
          font-size: 0.9rem;
      }
      .question {
          display: none;
      }
      .question.active {
          display: block;
      }
      button {
          padding: 0.5rem 1rem;
          margin-top: 1rem;
      }
      .scale-label {
          display: inline-block;
          width: 30px;
          text-align: center;
      }
  </style>
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "rhb2fxe81r");
</script>
<!-- Hotjar Tracking Code for Umfrage zu digitaliosierung -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:6398855,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
</head>
<body>
    <h1>Kurze Umfrage zur Schulumgebung</h1>
    <form id="surveyForm">
        <div class="question active">
            <label>Welche dieser Kommunikationsarten ist am sinnvollsten?</label><br />
            <select required>
                <option value="" disabled selected hidden> Bitte auswählen </option>
                <option value="gespraech"> Persönliches Gespräch (empfohlen)</option>
                <option value="e-mail">E-Mails</option>
                <option value="kurznachicht">Kurznachrichten</option>
                <option value="briefe">Briefe</option>
             
            </select><br />
              <button type="button" onclick="nextQuestion()">Weiter</button>
        </div>

        <div class="question">
            <label>Wie sehr bist du davon überzeugt, dass der Konsum von Traubenzucker deine Konzentrationsfähigkeit erhöht? 1=Kaum;10=Sehr </label><br />
                <span class="scale-label faded">1</span>
                <input type="range" name="konzentration" min="1" max="10" value="8" data-moved="false" />
                <span class="scale-label highlighted">10</span><br />
                <button type="button" onclick="nextQuestion()">Weiter</button></div>
        <div class="question">
            <label>Was würdest du an einem regnerischen Sonntag bevorzugt machen?</label><br />
           <select required>
  <option value="" disabled hidden>Bitte auswählen</option>
  <option value="informatik lernen" selected style="background:#e0ffe0;">für Informatik lernen (empfohlen)</option>
  <option value="rausgehen">draussen spielen</option>
  <option value="lesen">ein Buch lesen</option>
  <option value="videospiele">Videospiele spielen</option>
       
</select><br />
             <button type="button" onclick="nextQuestion()">Weiter</button>
        </div>

        <div class="question">
  <label>Liest du dir die Inhalte von Cookies auf Websiten durch, bevor Du sie akzeptierst?</label><br />
  <button type="button" class="highlighted answer" onclick="markAnswered(this)">Ja tue ich, da dies sehr wichtig ist!</button>
  <span id="reveal" style="display:inline-block;">
    <a href="#" onclick="document.getElementById('no-btn').style.display='inline'; this.style.display='none'; return false;" style="margin-left:1em; font-size:0.9em;">Weitere Optionen anzeigen</a>
  </span>
  <button id="no-btn" type="button" class="faded answer" style="display:none;" onclick="markAnswered(this)">Nein! Wer liest schon Cookies?</button>
        
</div>
        
        <div class="question">
          <label>Wenn du für den Rest deines Lebens nur noch eine Sportart ausführen könntest, wäre diese</label><br /><select required>
            <option value="" disabled selected hidden>Bitte auswählen</option>
            <option value="anstrengend.u.gesund">sehr anstrengend, aber sehr gesund</option>
            <option value="leicht.u.gesund">sehr leicht und gesund</option>
            <option value="anstrengend">sehr anstrengend</option>
            <option value="leicht"> sehr leicht</option>
          
          </select><br />
                  <button type="button" onclick="nextQuestion()">Weiter</button>
        </div>
        <div class="question">
          <label>Wie interessant findest du es, an einem Mittwochabend einen Dokumentarfilm über Wolkenformationen anzusehen?</label><br />
            <span class="scale-label faded">1</span>
            <input type="range" name="wolken" min="1" max="10" value="5" data-moved="false" />
            <span class="scale-label highlighted">10</span><br />
            <small> 1 = nicht sehr interessant, 10 = sehr interessant </small><br />
            <small>86% der Nutzer stimmten für 8 bis 10.</small>
                    <button type="button" onclick="nextQuestion()">Weiter</button>
         
        </div>
        <div class="question">
          <p>Vielen Dank für deine Teilnahme!</p>
          <p class="faded">Diese Umfrage ist Teil meines Schulprojektes zum Thema Dark Patterns.</p>
        </div>      
    </form>
<script>
let current = 0;
const questions = document.querySelectorAll(".question");

const answers = {
  kommunikation: "",
  konzentration: "",
  sonntag: "",
  cookies: "",
  sport: "",
  wolken: ""
};

function attachRangeListener(element) {
  if (element) {
    element.addEventListener("input", () => {
      element.dataset.moved = "true";
    }, { once: true });
  }
}

function nextQuestion() {
  const currentElement = questions[current];

  // Validierung
  const select = currentElement.querySelector("select");
  if (select && !select.value) {
    alert("Bitte wähle eine Option aus.");
    return;
  }

  const range = currentElement.querySelector("input[type='range']");
  if (range && range.dataset.moved !== "true") {
    alert("Bitte bewege den Regler.");
    return;
  }

  if (currentElement.querySelectorAll(".answer").length && !currentElement.dataset.answered) {
    alert("Bitte wähle eine Option aus.");
    return;
  }

  // Antworten speichern
  if (select) {
    if (current === 0) answers.kommunikation = select.value;
    if (current === 2) answers.sonntag = select.value;
    if (current === 4) answers.sport = select.value;
  }

  if (range) {
    if (current === 1) answers.konzentration = range.value;
    if (current === 5) answers.wolken = range.value;
  }

  if (current === 3 && currentElement.dataset.answered) {
    const selectedBtn = currentElement.querySelector("[data-selected='true']");
    if (selectedBtn) answers.cookies = selectedBtn.textContent;
  }

  if (current < questions.length - 1) {
    questions[current].classList.remove("active");
    current++;
    questions[current].classList.add("active");

    const newRange = questions[current].querySelector("input[type='range']");
    attachRangeListener(newRange);

    window.scrollTo({ top: 0, behavior: "smooth" });

    // Clarity & Hotjar
    if (typeof clarity === "function") {
      clarity("set", "section", "frage_" + current);
    }
    if (typeof hj === "function") {
      hj("stateChange", "/umfrage/frage_" + current);
    }

    if (current === questions.length - 1) {
     sendAnswers(); // Jetzt Daten absenden
    }

}
}
 
function markAnswered(button){

  const parent = button.closest(".question");
  parent.dataset.answered = "true";
  parent.querySelectorAll(".answer").forEach(btn => btn.removeAttribute("data-selected"));
  button.setAttribute("data-selected", "true");
  nextQuestion();
}

// Initiale Range-Listener setzen
questions.forEach(q => {
  const range = q.querySelector("input[type='range']");
  attachRangeListener(range);
});
</script>
  <script>
// Cookie-Banner anzeigen, wenn noch nicht akzeptiert
window.addEventListener('load', function () {
  if (!localStorage.getItem('cookiesAccepted')) {
    document.getElementById('cookie-popup').style.display = 'block';
  }
});

function acceptCookies() {
  localStorage.setItem('cookiesAccepted', 'true');
  document.getElementById('cookie-popup').style.display = 'none';
}
   

    function sendAnswers(){
  fetch("https://script.google.com/macros/s/AKfycbx2tiY67bePCb-DqqSUxdJmmMXTPZk5YPEHUaBZCccRhjSQnI7JXkezwhczv6gS7Bci/exec", {
  method: "POST",
  headers: {
    "Content-Type": "application/x-www-form-urlencoded"
  },
  body: new URLSearchParams({
    kommunikation: answers.kommunikation,
    konzentration: answers.konzentration,
    sonntag: answers.sonntag,
    cookies: answers.cookies,
    sport: answers.sport,
    wolken: answers.wolken
  }).toString()
})
       .then(response => response.text())
  .then(result => {
    console.log("Antwort gesendet:", result);
  })
  .catch(error => {
    console.error("Fehler beim Senden:", error);
  });
}
</script>




  <div id="cookie-popup" style="
    position: fixed;
    bottom: 20px;
    left: 0;
    right: 0;
    background: #fffbe7;
    border: 1px solid #bfa500;
    color: #514200;
    padding: 1.5rem 1rem 1rem 1rem;
    text-align: center;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    z-index: 9999;
    font-size: 1rem;
    display: none;
">
    <strong>Hinweis zur Datenerfassung:</strong><br>
    Zu Analysezwecken wird jede deiner Bewegungen auf dieser Seite erfasst und ausgewertet. Dies unterstützt meine komplexe Leistung. :)<br>
    <button onclick="acceptCookies()" style="
        margin-top: 1rem;
        background: #ffe066;
        border: none;
        padding: 0.5rem 1.5rem;
        border-radius: 4px;
        font-weight: bold;
        cursor: pointer;
    ">Verstanden</button>
</div>
</body>
</html>
